{% extends "based_layout.html" %}

{% load static %}

{% block style %}
    <link rel="stylesheet" href="{% static 'css/features/statistic.css' %}">
    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
{% endblock %}
{% block title %}Статистика{% endblock %}

{% block center-content %}

    <div id="main-container">
        {% for rate_name, rate_movies in movies_rating.items %}

            <div class="row movies-container">

                <h2>{{ rate_name }}</h2>
                {% for m in rate_movies %}

                    <div class="movie" data-kp-id="{{ m.kp_id }}">
                        <div class="poster-container">
                            <img class="poster" src="{{ m.poster_local }}" alt="" loading="lazy" data-kp-id="{{ m.kp_id }}">
                            <div class="rating">
                                <span><img src="{% static 'img/imdb.svg' %}" alt="imdb">{{ m.rating_imdb }}</span>
                                <span><img src="{% static 'img/kinopoisk.svg' %}" alt="kp">{{ m.rating_kp }}</span>
                                <span><img src="{% static 'img/icon.png' %}" alt="polka">{{ m.rating }}</span>
                            </div>
                        </div>

                        <h4>{{ m.name }}</h4>
                    </div>

                {% endfor %}
            </div>

            <br>
        {% endfor %}

    </div>



    <h2>Распределение оценок на Кинопоиске</h2>
    {{ graphs.kp_distribution|safe }}

    <h2>Мы vs Мир: где мы добрее/суровее IMDb</h2>
    {{ graphs.club_vs_imdb|safe }}

    <h2>Топ-10 переоценённых нами фильмов</h2>
    {{ graphs.overrated|safe }}

    <h2 sash="true">Топ-10 недооценённых нами фильмов</h2>
    {{ graphs.underrated|safe }}

    <h2>Жанровая карта кинополки</h2>
    {{ graphs.genres_treemap|safe }}

{% endblock %}

{% block right-content %}

    <div id="stats">
        <h3>Общее</h3>
        <table>
            <tbody>
            {% for stat_name, stat in statistic.items %}
                <tr>
                    <td>{{ stat_name }}</td>
                    <td>{{ stat }}</td>
                </tr>
            {% endfor %}
            </tbody>

        </table>
    </div>
    <br>

    <div id="genres">
        <h3>Жанры</h3>
        {% autoescape off %} {{ genres_table }} {% endautoescape %}
    </div>



{% endblock %}